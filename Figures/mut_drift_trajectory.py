"""
Created on Sun 27 Jan 13:24:34 2019

@author: R Carthigesan

Script used to plot site frequency trajectories from results generated by dynamics_simulator_parallel.py.
"""

import numpy as np
import matplotlib.pyplot as plt
import matplotlib

plt.style.use('ggplot')
# matplotlib.rcParams.update({'font.size': 20})  # for full width figures
matplotlib.rcParams.update({'font.size': 25})  # for half-width figures)


def log_trans(f, thresh):
    # returns freq transformed by ln(f/(1-f)) with some minimum freq threshold so displayable on log
    return np.log((f+thresh)/(1.0 - f-thresh))


parent_dir = "C:/Users/raman/OneDrive/Work/Cambridge_MASt_Physics/Project/Python/Genetic_Hitchhiking/Results/"
test_name = 'test_vs_p9'

results = np.load(parent_dir + test_name + ".npy")

plt_thresh = 10**(-3.5)

frequencies = results[:, :-1]
transformed_frequencies = log_trans(frequencies, plt_thresh)
#
# fig = plt.figure()
# ax = fig.add_subplot(111)
#
# i= 3929
# ax.plot(results[263:409, -1] - 263, frequencies[263:409, i]*5 - frequencies[263, i]*5)
# #
# for i in range(10000):
#     if sum(frequencies[:,i] > 0.3) > 0:
#         print(i)

no_plot = [49, 181, 260, 271, 406, 681, 847, 933, 1172, 1228, 1888, 2084, 2556, 2681, 2840, 2965, 3483, 3604, 3795,
           3929, 3978, 4380, 4699, 4716, 4773, 5023, 5338, 6142, 6243, 6656, 6744, 7808, 7839, 8162, 8937, 9038]

fig2 = plt.figure()
ax2 = fig2.add_subplot(111)
for j in range(500):
    if j not in no_plot:
        ax2.plot(results[:,-1], frequencies[:,j])

ax2.set_xlabel('Time')
ax2.set_ylabel('Frequency')
ax2.set_yticklabels([])
ax2.set_xticklabels([])
# ax.set_ylim((-plt_thresh, plt_thresh))
# ax.set_xlim((0, results.shape[0] - 1))
# ax.tick_params(axis='y', colors='white')
# major_ticks = [-plt_thresh, -3, -2, -1, 0, 1, 2, 3, plt_thresh]
# major_tick_labels = ['0', '0.001', '0.01', '0.1', '0.5', '0.9', '0.99', '0.999', '1']
# ax.tick_params(axis='y', colors='black')
# ax.set_yticks(major_ticks)
# ax.set_yticklabels(major_tick_labels)
