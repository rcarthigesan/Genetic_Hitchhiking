"""
Created on Sun 27 Jan 13:24:34 2019

@author: R Carthigesan

Script used to plot site frequency trajectories from results generated by dynamics_simulator_parallel.py.
"""

import numpy as np
import matplotlib.pyplot as plt
import matplotlib

# matplotlib.rcParams.update({'font.size': 20})  # for full width figures
matplotlib.rcParams.update({'font.size': 25})  # for half-width figures


def log_trans(f, thresh):
    # returns freq transformed by ln(f/(1-f)) with some minimum freq threshold so displayable on log
    return np.log((f+thresh)/(1.0 - f-thresh))


parent_dir = "C:/Users/raman/OneDrive/Work/Cambridge_MASt_Physics/Project/Python/Genetic_Hitchhiking/Results/"
test_name = 'test_vs_p9'

results = np.load(parent_dir + test_name + ".npy")

plt_thresh = 10**(-3.5)

frequencies = results[:, :-1]
transformed_frequencies = log_trans(frequencies, plt_thresh)

fig = plt.figure()
ax = fig.add_subplot(111)

for i in (np.arange(int(1000))):
    ax.plot(results[:, -1], frequencies[:, i])
    print(i)

# ax.set_xlabel('Generation')
# ax.set_ylabel('Frequency')
# ax.set_ylim((-plt_thresh, plt_thresh))
# ax.set_xlim((0, results.shape[0] - 1))
# ax.tick_params(axis='y', colors='white')
# major_ticks = [-plt_thresh, -3, -2, -1, 0, 1, 2, 3, plt_thresh]
# major_tick_labels = ['0', '0.001', '0.01', '0.1', '0.5', '0.9', '0.99', '0.999', '1']
# ax.tick_params(axis='y', colors='black')
# ax.set_yticks(major_ticks)
# ax.set_yticklabels(major_tick_labels)
